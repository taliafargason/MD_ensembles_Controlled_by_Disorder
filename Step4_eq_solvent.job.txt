#!/bin/bash
#SBATCH --partition=pascalnodes
#SBATCH --job-name=eqsolvent_CUDA
#SBATCH --error=eqsolvent_CUDA.err
#SBATCH --output=eqsolvent_CUDA.out
#SBATCH --gres=gpu:1
#SBATCH --time=12:00:00
#SBATCH --mem-per-cpu=5G
#SBATCH --no-requeue
#SBATCH --mail-type=ALL
#SBATCH --mail-user=tfarg@uab.edu


module reset
module load OpenMPI/4.1.5-GCC-12.3.0 
module load Amber/20.11-fosscuda-2020b-AmberTools-21.3 
module load CUDA/11.6.0


for ((i=1;i<=30;i++)); do
    ambpdb -p SRSF1-SolvI_${i}.prmtop -c SRSF1-min-SolvI_${i}.rst > SRSF1-min-SolvI_${i}.pdb
	pmemd.cuda -O -i eq-solvent.in -p SRSF1_SolvI_CMAP_${i}.prmtop -c SRSF1-min-SolvI_${i}.rst -ref SRSF1-min-SolvI_${i}.rst -o eq-solvent_${i}.out -r SRSF1-eq-SolvI_${i}.rst -x SRSF1-eq-SolvI_${i}.mdcrd -inf SRSF1-eq-SolvI_${i}.mdinfo
	ambpdb -p SRSF1-SolvI_${i}.prmtop -c SRSF1-eq-SolvI_${i}.rst > SRSF1-eq-SolvI_${i}.pdb
done
